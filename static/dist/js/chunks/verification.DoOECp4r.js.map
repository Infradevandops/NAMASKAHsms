{"version":3,"file":"verification.DoOECp4r.js","sources":["../../../js/modules/verification.js"],"sourcesContent":["/**\n * Verification Page Module\n * Handles SMS verification purchase and display\n */\n\nclass VerificationManager {\n    constructor() {\n        this.currentVerification = null;\n        this.pollingInterval = null;\n        this.countdownInterval = null;\n        this.services = [];\n        this.countries = [];\n        this.init();\n    }\n\n    async init() {\n        this.setupEventListeners();\n        await this.loadServices();\n        await this.loadCountries();\n        await this.loadUserBalance();\n        await this.loadVerificationHistory();\n    }\n\n    setupEventListeners() {\n        // Form submission\n        document.getElementById('verification-form').addEventListener('submit', (e) => {\n            e.preventDefault();\n            this.handleFormSubmit();\n        });\n\n        // Service and country change\n        document.getElementById('service-select').addEventListener('change', () => this.updateCostEstimate());\n        document.getElementById('country-select').addEventListener('change', () => this.updateCostEstimate());\n\n        // Copy buttons\n        document.getElementById('copy-phone-btn')?.addEventListener('click', () => this.copyToClipboard('phone-number'));\n        document.getElementById('copy-code-btn')?.addEventListener('click', () => this.copyToClipboard('sms-code'));\n\n        // Action buttons\n        document.getElementById('release-btn')?.addEventListener('click', () => this.releaseNumber());\n        document.getElementById('new-verification-btn')?.addEventListener('click', () => this.resetForm());\n\n        // Confirmation\n        document.getElementById('confirm-purchase-btn')?.addEventListener('click', () => this.confirmPurchase());\n    }\n\n    async loadServices() {\n        try {\n            const response = await axios.get('/api/pricing/services');\n            this.services = Object.keys(response.data.services);\n            this.populateServiceSelect();\n        } catch (error) {\n            console.error('Failed to load services:', error);\n            this.showError('Failed to load services');\n        }\n    }\n\n    async loadCountries() {\n        try {\n            const response = await axios.get('/api/pricing/countries');\n            this.countries = Object.keys(response.data.countries);\n            this.populateCountrySelect();\n        } catch (error) {\n            console.error('Failed to load countries:', error);\n            this.showError('Failed to load countries');\n        }\n    }\n\n    async loadUserBalance() {\n        try {\n            const response = await axios.get('/api/user/balance');\n            const balance = response.data.credits;\n            document.getElementById('user-balance').textContent = `$${balance.toFixed(2)}`;\n            document.getElementById('balance-display').textContent = `$${balance.toFixed(2)}`;\n        } catch (error) {\n            console.error('Failed to load balance:', error);\n        }\n    }\n\n    async loadVerificationHistory() {\n        try {\n            const response = await axios.get('/api/verification/history?limit=10');\n            this.populateVerificationHistory(response.data.verifications);\n        } catch (error) {\n            console.error('Failed to load history:', error);\n        }\n    }\n\n    populateServiceSelect() {\n        const select = document.getElementById('service-select');\n        this.services.forEach(service => {\n            const option = document.createElement('option');\n            option.value = service;\n            option.textContent = service.charAt(0).toUpperCase() + service.slice(1);\n            select.appendChild(option);\n        });\n    }\n\n    populateCountrySelect() {\n        const select = document.getElementById('country-select');\n        this.countries.forEach(country => {\n            const option = document.createElement('option');\n            option.value = country;\n            option.textContent = country;\n            select.appendChild(option);\n        });\n    }\n\n    populateVerificationHistory(verifications) {\n        const tbody = document.getElementById('verification-history');\n        tbody.innerHTML = '';\n\n        if (verifications.length === 0) {\n            tbody.innerHTML = '<tr><td colspan=\"7\" class=\"text-center text-muted\">No verifications yet</td></tr>';\n            return;\n        }\n\n        verifications.forEach(v => {\n            const row = document.createElement('tr');\n            const statusBadge = this.getStatusBadge(v.status);\n            const date = new Date(v.created_at).toLocaleDateString();\n\n            row.innerHTML = `\n                <td>${v.service}</td>\n                <td>${v.country}</td>\n                <td><code>${v.phone_number}</code></td>\n                <td>${statusBadge}</td>\n                <td>$${v.cost.toFixed(2)}</td>\n                <td>${date}</td>\n                <td>\n                    <button class=\"btn btn-sm btn-outline-primary\" onclick=\"verificationManager.viewDetails('${v.id}')\">\n                        <i class=\"fas fa-eye\"></i>\n                    </button>\n                </td>\n            `;\n            tbody.appendChild(row);\n        });\n    }\n\n    getStatusBadge(status) {\n        const badges = {\n            'pending': '<span class=\"badge bg-warning\">Pending</span>',\n            'completed': '<span class=\"badge bg-success\">Completed</span>',\n            'timeout': '<span class=\"badge bg-danger\">Timeout</span>',\n            'released': '<span class=\"badge bg-secondary\">Released</span>'\n        };\n        return badges[status] || `<span class=\"badge bg-secondary\">${status}</span>`;\n    }\n\n    async updateCostEstimate() {\n        const service = document.getElementById('service-select').value;\n        const country = document.getElementById('country-select').value;\n\n        if (!service || !country) {\n            document.getElementById('estimated-cost').textContent = '$0.00';\n            return;\n        }\n\n        try {\n            const response = await axios.get('/api/pricing/estimate', {\n                params: {\n                    service,\n                    country,\n                    tier: 'STANDARD',\n                    quantity: 1\n                }\n            });\n\n            const cost = response.data.total_cost;\n            document.getElementById('estimated-cost').textContent = `$${cost.toFixed(2)}`;\n\n            // Check balance\n            const balanceText = document.getElementById('user-balance').textContent;\n            const balance = parseFloat(balanceText.replace('$', ''));\n            const insufficientAlert = document.getElementById('insufficient-balance-alert');\n\n            if (balance < cost) {\n                insufficientAlert.classList.remove('d-none');\n                document.getElementById('purchase-btn').disabled = true;\n            } else {\n                insufficientAlert.classList.add('d-none');\n                document.getElementById('purchase-btn').disabled = false;\n            }\n        } catch (error) {\n            console.error('Failed to estimate cost:', error);\n        }\n    }\n\n    async handleFormSubmit() {\n        const service = document.getElementById('service-select').value;\n        const country = document.getElementById('country-select').value;\n        const capability = document.querySelector('input[name=\"capability\"]:checked').value;\n\n        if (!service || !country) {\n            this.showError('Please select a service and country');\n            return;\n        }\n\n        // Show confirmation modal\n        document.getElementById('confirm-service').textContent = service;\n        document.getElementById('confirm-country').textContent = country;\n\n        const costText = document.getElementById('estimated-cost').textContent;\n        document.getElementById('confirm-cost').textContent = costText;\n\n        const balanceText = document.getElementById('user-balance').textContent;\n        const balance = parseFloat(balanceText.replace('$', ''));\n        const cost = parseFloat(costText.replace('$', ''));\n        document.getElementById('confirm-balance').textContent = `$${(balance - cost).toFixed(2)}`;\n\n        const confirmModal = new bootstrap.Modal(document.getElementById('confirmation-modal'));\n        confirmModal.show();\n    }\n\n    async confirmPurchase() {\n        const service = document.getElementById('service-select').value;\n        const country = document.getElementById('country-select').value;\n        const capability = document.querySelector('input[name=\"capability\"]:checked').value;\n\n        // Close confirmation modal\n        bootstrap.Modal.getInstance(document.getElementById('confirmation-modal')).hide();\n\n        // Show loading modal\n        const loadingModal = new bootstrap.Modal(document.getElementById('loading-modal'));\n        loadingModal.show();\n\n        try {\n            const response = await axios.post('/api/verification/request', {\n                service,\n                country,\n                capability\n            });\n\n            this.currentVerification = response.data;\n            loadingModal.hide();\n\n            // Show verification result\n            this.displayVerificationResult();\n\n            // Start polling for SMS\n            this.startPolling();\n\n            // Start countdown\n            this.startCountdown();\n\n            // Hide form, show result\n            document.getElementById('verification-form').parentElement.classList.add('d-none');\n            document.getElementById('verification-result').classList.remove('d-none');\n            document.getElementById('help-card').classList.add('d-none');\n\n            this.showSuccess('Verification purchased successfully!');\n        } catch (error) {\n            loadingModal.hide();\n            const message = error.response?.data?.detail || 'Failed to purchase verification';\n            this.showError(message);\n        }\n    }\n\n    displayVerificationResult() {\n        const v = this.currentVerification;\n\n        // Display phone number\n        document.getElementById('phone-number').value = v.phone_number;\n\n        // Generate QR code\n        const qrContainer = document.getElementById('qr-code');\n        qrContainer.innerHTML = '';\n        new QRCode(qrContainer, {\n            text: v.phone_number,\n            width: 150,\n            height: 150\n        });\n    }\n\n    startPolling() {\n        let pollCount = 0;\n        const maxPolls = 600; // 20 minutes at 2-second intervals\n        \n        // Poll every 2 seconds\n        this.pollingInterval = setInterval(async () => {\n            pollCount++;\n            \n            try {\n                const response = await axios.get(`/api/verification/${this.currentVerification.verification_id}`);\n                const verification = response.data;\n\n                if (verification.status === 'completed' && verification.sms_code) {\n                    this.handleSMSReceived(verification);\n                    clearInterval(this.pollingInterval);\n                    return;\n                }\n\n                // Check if timeout reached\n                if (pollCount >= maxPolls) {\n                    clearInterval(this.pollingInterval);\n                    this.handleTimeout();\n                    return;\n                }\n            } catch (error) {\n                console.error('Polling error:', error);\n                // Continue polling even on error\n            }\n        }, 2000);\n    }\n\n    handleSMSReceived(verification) {\n        // Hide waiting message\n        document.getElementById('sms-waiting').classList.add('d-none');\n\n        // Show received message\n        document.getElementById('sms-received').classList.remove('d-none');\n\n        // Display SMS code with animation\n        const codeElement = document.getElementById('sms-code');\n        codeElement.value = verification.sms_code;\n        codeElement.style.animation = 'none';\n        setTimeout(() => {\n            codeElement.style.animation = 'slideIn 0.5s ease';\n        }, 10);\n        document.getElementById('sms-code-section').classList.remove('d-none');\n\n        // Display full SMS text\n        if (verification.sms_text) {\n            document.getElementById('sms-text').value = verification.sms_text;\n            document.getElementById('sms-text-section').classList.remove('d-none');\n        }\n\n        // Display receipt timestamp\n        if (verification.sms_received_at) {\n            const receivedTime = new Date(verification.sms_received_at).toLocaleTimeString();\n            const timestampEl = document.createElement('small');\n            timestampEl.className = 'text-muted d-block mt-2';\n            timestampEl.textContent = `Received at: ${receivedTime}`;\n            document.getElementById('sms-code-section').appendChild(timestampEl);\n        }\n\n        // Stop countdown\n        clearInterval(this.countdownInterval);\n        document.getElementById('countdown-bar').style.width = '100%';\n        document.getElementById('countdown-text').textContent = 'SMS Received!';\n\n        this.showSuccess('SMS received! Code is ready to use.');\n    }\n\n    startCountdown() {\n        let timeRemaining = 1200; // 20 minutes in seconds\n\n        this.countdownInterval = setInterval(() => {\n            timeRemaining--;\n\n            const minutes = Math.floor(timeRemaining / 60);\n            const seconds = timeRemaining % 60;\n            const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;\n\n            document.getElementById('countdown-text').textContent = timeString;\n\n            const percentage = (timeRemaining / 1200) * 100;\n            document.getElementById('countdown-bar').style.width = percentage + '%';\n\n            if (timeRemaining <= 0) {\n                clearInterval(this.countdownInterval);\n                this.handleTimeout();\n            }\n        }, 1000);\n    }\n\n    handleTimeout() {\n        // Hide waiting message\n        document.getElementById('sms-waiting').classList.add('d-none');\n\n        // Show timeout message\n        document.getElementById('sms-timeout').classList.remove('d-none');\n\n        // Stop polling\n        clearInterval(this.pollingInterval);\n        clearInterval(this.countdownInterval);\n\n        // Update countdown bar to show timeout\n        document.getElementById('countdown-bar').style.width = '0%';\n        document.getElementById('countdown-text').textContent = '0:00';\n\n        // Show error with retry option\n        const errorModal = document.getElementById('error-modal');\n        document.getElementById('error-message').innerHTML = `\n            <strong>SMS Timeout!</strong><br>\n            No SMS received within 20 minutes.<br><br>\n            <small>This can happen if:</small>\n            <ul style=\"margin-top: 0.5rem; margin-bottom: 0;\">\n                <li>The service is experiencing delays</li>\n                <li>The phone number is invalid</li>\n                <li>The SMS was blocked</li>\n            </ul>\n            <br>\n            <a href=\"/billing\" class=\"alert-link\">Add more credits</a> to try again with a different number.\n        `;\n        const modal = new bootstrap.Modal(errorModal);\n        modal.show();\n    }\n\n    async releaseNumber() {\n        if (!this.currentVerification) return;\n\n        if (!confirm('Are you sure you want to release this number?')) {\n            return;\n        }\n\n        try {\n            await axios.post(`/api/verification/${this.currentVerification.verification_id}/release`);\n            this.showSuccess('Number released successfully');\n            this.resetForm();\n        } catch (error) {\n            const message = error.response?.data?.detail || 'Failed to release number';\n            this.showError(message);\n        }\n    }\n\n    resetForm() {\n        // Clear form\n        document.getElementById('verification-form').reset();\n        this.currentVerification = null;\n\n        // Clear intervals\n        clearInterval(this.pollingInterval);\n        clearInterval(this.countdownInterval);\n\n        // Show form, hide result\n        document.getElementById('verification-form').parentElement.classList.remove('d-none');\n        document.getElementById('verification-result').classList.add('d-none');\n        document.getElementById('help-card').classList.remove('d-none');\n\n        // Reset SMS sections\n        document.getElementById('sms-waiting').classList.remove('d-none');\n        document.getElementById('sms-received').classList.add('d-none');\n        document.getElementById('sms-timeout').classList.add('d-none');\n        document.getElementById('sms-code-section').classList.add('d-none');\n        document.getElementById('sms-text-section').classList.add('d-none');\n\n        // Reload history\n        this.loadVerificationHistory();\n    }\n\n    async viewDetails(verificationId) {\n        try {\n            const response = await axios.get(`/api/verification/${verificationId}`);\n            const v = response.data;\n\n            alert(`\nService: ${v.service}\nCountry: ${v.country}\nPhone: ${v.phone_number}\nStatus: ${v.status}\nCost: $${v.cost}\n${v.sms_code ? `SMS Code: ${v.sms_code}` : ''}\n            `);\n        } catch (error) {\n            this.showError('Failed to load verification details');\n        }\n    }\n\n    copyToClipboard(elementId) {\n        const element = document.getElementById(elementId);\n        const text = element.value;\n\n        navigator.clipboard.writeText(text).then(() => {\n            // Show success toast\n            this.showSuccess('Copied to clipboard!');\n            \n            // Visual feedback on button\n            const button = event.target.closest('button');\n            if (button) {\n                const originalHTML = button.innerHTML;\n                button.innerHTML = '<i class=\"fas fa-check\"></i> Copied!';\n                button.disabled = true;\n                \n                setTimeout(() => {\n                    button.innerHTML = originalHTML;\n                    button.disabled = false;\n                }, 2000);\n            }\n        }).catch(() => {\n            // Fallback for older browsers\n            try {\n                element.select();\n                document.execCommand('copy');\n                this.showSuccess('Copied to clipboard!');\n            } catch (err) {\n                this.showError('Failed to copy to clipboard');\n            }\n        });\n    }\n\n    showError(message) {\n        document.getElementById('error-message').textContent = message;\n        const modal = new bootstrap.Modal(document.getElementById('error-modal'));\n        modal.show();\n    }\n\n    showSuccess(message) {\n        document.getElementById('toast-message').textContent = message;\n        const toast = new bootstrap.Toast(document.getElementById('success-toast'));\n        toast.show();\n    }\n}\n\n// Initialize on page load\nlet verificationManager;\ndocument.addEventListener('DOMContentLoaded', () => {\n    verificationManager = new VerificationManager();\n});\n"],"names":["VerificationManager","constructor","this","currentVerification","pollingInterval","countdownInterval","services","countries","init","setupEventListeners","loadServices","loadCountries","loadUserBalance","loadVerificationHistory","_a","_b","_c","_d","_e","document","getElementById","addEventListener","e","preventDefault","handleFormSubmit","updateCostEstimate","copyToClipboard","releaseNumber","resetForm","confirmPurchase","response","axios","get","Object","keys","data","populateServiceSelect","error","showError","populateCountrySelect","balance","credits","textContent","toFixed","populateVerificationHistory","verifications","select","forEach","service","option","createElement","value","charAt","toUpperCase","slice","appendChild","country","tbody","innerHTML","length","v","row","statusBadge","getStatusBadge","status","date","Date","created_at","toLocaleDateString","phone_number","cost","id","pending","completed","timeout","released","params","tier","quantity","total_cost","balanceText","parseFloat","replace","insufficientAlert","classList","remove","disabled","add","querySelector","costText","bootstrap","Modal","show","capability","getInstance","hide","loadingModal","post","displayVerificationResult","startPolling","startCountdown","parentElement","showSuccess","message","detail","qrContainer","QRCode","text","width","height","pollCount","setInterval","async","verification","verification_id","sms_code","handleSMSReceived","clearInterval","handleTimeout","codeElement","style","animation","setTimeout","sms_text","sms_received_at","receivedTime","toLocaleTimeString","timestampEl","className","timeRemaining","timeString","Math","floor","toString","padStart","percentage","errorModal","confirm","reset","viewDetails","verificationId","alert","elementId","element","navigator","clipboard","writeText","then","button","event","target","closest","originalHTML","catch","execCommand","err","Toast"],"mappings":"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"}