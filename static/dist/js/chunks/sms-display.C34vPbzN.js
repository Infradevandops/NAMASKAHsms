var t,e,n=Object.getOwnPropertyNames,o=(t={"js/chunks/sms-display.C34vPbzN.js"(t,e){class n{constructor(){this.pollingInterval=null,this.countdownInterval=null,this.maxPolls=600,this.pollCount=0}startPolling(t){this.pollCount=0,this.pollingInterval=setInterval(async()=>{this.pollCount++;try{const e=(await axios.get(`/api/verification/${t}`)).data;if("completed"===e.status&&e.sms_code)return this.displaySMS(e),void this.stopPolling();if(this.pollCount>=this.maxPolls)return this.handleTimeout(),void this.stopPolling()}catch(e){}},2e3)}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}displaySMS(t){const e=document.getElementById("sms-waiting");e&&e.classList.add("d-none");const n=document.getElementById("sms-received");n&&n.classList.remove("d-none");const o=document.getElementById("sms-code");o&&(o.value=t.sms_code,o.style.animation="none",setTimeout(()=>{o.style.animation="slideIn 0.5s ease"},10));const s=document.getElementById("sms-code-section");if(s&&s.classList.remove("d-none"),t.sms_text){const e=document.getElementById("sms-text");e&&(e.value=t.sms_text);const n=document.getElementById("sms-text-section");n&&n.classList.remove("d-none")}t.sms_received_at&&this.displayTimestamp(t.sms_received_at),this.updateCountdownToComplete()}displayTimestamp(t){const e=new Date(t).toLocaleTimeString(),n=document.getElementById("sms-code-section");if(n){const t=n.querySelector(".sms-timestamp");t&&t.remove();const o=document.createElement("small");o.className="text-muted d-block mt-2 sms-timestamp",o.textContent=`Received at: ${e}`,n.appendChild(o)}}updateCountdownToComplete(){const t=document.getElementById("countdown-bar"),e=document.getElementById("countdown-text");t&&(t.style.width="100%"),e&&(e.textContent="SMS Received!"),this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}handleTimeout(){const t=document.getElementById("sms-waiting");t&&t.classList.add("d-none");const e=document.getElementById("sms-timeout");e&&e.classList.remove("d-none");const n=document.getElementById("countdown-bar"),o=document.getElementById("countdown-text");n&&(n.style.width="0%"),o&&(o.textContent="0:00"),this.showTimeoutError()}showTimeoutError(){const t=document.getElementById("error-modal");if(!t)return;const e=document.getElementById("error-message");e&&(e.innerHTML='\n                <strong>SMS Timeout!</strong><br>\n                No SMS received within 20 minutes.<br><br>\n                <small style="color: #666;">This can happen if:</small>\n                <ul style="margin-top: 0.5rem; margin-bottom: 0.5rem; padding-left: 1.5rem;">\n                    <li>The service is experiencing delays</li>\n                    <li>The phone number is invalid</li>\n                    <li>The SMS was blocked by carrier</li>\n                </ul>\n                <br>\n                <a href="/billing" class="alert-link">Add more credits</a> to try again with a different number.\n            '),new bootstrap.Modal(t).show()}startCountdown(){let t=1200;this.countdownInterval=setInterval(()=>{t--;const e=`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`,n=document.getElementById("countdown-text");n&&(n.textContent=e);const o=t/1200*100,s=document.getElementById("countdown-bar");s&&(s.style.width=o+"%"),t<=0&&(clearInterval(this.countdownInterval),this.countdownInterval=null)},1e3)}stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}reset(){this.stopPolling(),this.stopCountdown(),["sms-waiting","sms-received","sms-timeout","sms-code-section","sms-text-section"].forEach(t=>{const e=document.getElementById(t);e&&("sms-waiting"===t?e.classList.remove("d-none"):e.classList.add("d-none"))});const t=document.getElementById("countdown-bar"),e=document.getElementById("countdown-text");t&&(t.style.width="100%"),e&&(e.textContent="20:00")}}void 0!==e&&e.exports&&(e.exports=n)}},function(){return e||(0,t[n(t)[0]])((e={exports:{}}).exports,e),e.exports});export default o();
//# sourceMappingURL=sms-display.C34vPbzN.js.map
