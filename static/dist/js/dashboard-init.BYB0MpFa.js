import{T as t,E as e}from"./constants.mniaqQLw.js";import{h as n,g as s}from"./auth-store.D23SS89P.js";import{i as o}from"./tier-card.Qu4WmpSt.js";class i{constructor(){this.elements={totalSms:document.getElementById("total-sms"),successfulSms:document.getElementById("successful-sms"),totalSpent:document.getElementById("total-spent"),successRate:document.getElementById("success-rate")}}async load(){if(n()){this._log("info","Loading analytics...");try{const t=await fetch(e.ANALYTICS.SUMMARY,{credentials:"include",headers:s()});if(!t.ok)return;const n=await t.json();this._log("info","Analytics loaded",n),this._render(n)}catch(t){this._log("error","Analytics load failed",{error:t.message})}}}_render(t){if(this.elements.totalSms&&(this.elements.totalSms.textContent=t.total_verifications||0),this.elements.successfulSms&&(this.elements.successfulSms.textContent=t.successful_verifications||0),this.elements.totalSpent){const e=t.revenue||t.total_spent||0;this.elements.totalSpent.textContent=`$${e.toFixed(2)}`,this.elements.totalSpent.setAttribute("data-amount",e)}if(this.elements.successRate){const e=t.success_rate||0;this.elements.successRate.textContent=`${e.toFixed(1)}%`}}_log(t,e,n=null){window.FrontendLogger&&window.FrontendLogger[t](e,n)}}class a{constructor(){this.elements={loading:document.getElementById("activity-loading"),table:document.getElementById("activity-table"),empty:document.getElementById("empty-state"),body:document.getElementById("activity-body")}}async load(){if(n()){this._log("info","Loading recent activity...");try{const t=await fetch(e.DASHBOARD.ACTIVITY,{credentials:"include",headers:s()});if(this._hideLoading(),!t.ok)return void this._showEmpty();const n=await t.json();if(!n||0===n.length)return void this._showEmpty();this._log("info",`Activity loaded: ${n.length} items`),this._render(n)}catch(t){this._log("error","Activity load failed",{error:t.message}),this._hideLoading(),this._showEmpty()}}else this._showEmpty()}_render(t){let e="";for(const n of t){const t="completed"===n.status?"#10b981":"failed"===n.status?"#ef4444":"#f59e0b";e+=`\n                <tr style="border-bottom: 1px solid rgba(0,0,0,0.05);">\n                    <td style="padding: 12px;">${this._escapeHtml(n.service_name||"Unknown")}</td>\n                    <td style="padding: 12px;">${this._escapeHtml(n.phone_number||"-")}</td>\n                    <td style="padding: 12px;">${this._formatTime(n.created_at)}</td>\n                    <td style="padding: 12px; color: ${t};">${this._escapeHtml(n.status||"pending")}</td>\n                </tr>\n            `}this.elements.body&&(this.elements.body.innerHTML=e),this.elements.table&&(this.elements.table.style.display="table")}_hideLoading(){this.elements.loading&&(this.elements.loading.style.display="none")}_showEmpty(){this._hideLoading(),this.elements.empty&&(this.elements.empty.style.display="block")}_escapeHtml(t){if(!t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}_formatTime(t){if(!t)return"-";try{return new Date(t).toLocaleString()}catch(e){return t}}_log(t,e,n=null){window.FrontendLogger&&window.FrontendLogger[t](e,n)}}function l(){var t,e;const n=(null==(e=null==(t=window.tierCard)?void 0:t.currentData)?void 0:e.current_tier)||"freemium";"function"==typeof window.showTierCompareModal&&window.showTierCompareModal(n)}function d(){"function"==typeof window.closeTierCompareModal&&window.closeTierCompareModal()}function r(){const e=o("tier-card"),s=new i;s.load();const r=new a;return r.load(),setInterval(()=>{n()&&(e.load(),s.load())},t.REFRESH_INTERVAL),window.showComparePlansModal=l,window.closeComparePlansModal=d,{tierCard:e,analytics:s,activity:r}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r();
//# sourceMappingURL=dashboard-init.BYB0MpFa.js.map
